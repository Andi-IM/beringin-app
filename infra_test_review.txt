node.exe : FAIL src/infrastructure/repositories/seed.test.ts
At line:1 char:1
+ & "C:\nvm4w\nodejs/node.exe" "C:\nvm4w\nodejs/node_modules/npm/bin/np ...
+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : NotSpecified: (FAIL src/infras...es/seed.test.ts:String) [], RemoteException
    + FullyQualifiedErrorId : NativeCommandError
 
  seedData
    ΓêÜ should create concepts successfully (4 ms)
    ΓêÜ should create questions for each concept (2 ms)
    ΓêÜ should create initial progress for demo-user (3 ms)
    ΓêÜ should create progress with nextReview set to current time (1 ms)
    ΓêÜ should log success message
    ΓêÜ should create concepts with proper structure (2 ms)
    ΓêÜ should create questions with proper structure (3 ms)
    ΓêÜ should create progress with proper structure (2 ms)
    ├ù should handle seeding data multiple times (3 ms)
    ΓêÜ should maintain referential integrity between concepts and questions
    ΓêÜ should maintain referential integrity between concepts and progress

  ΓùÅ seedData ΓÇ║ should handle seeding data multiple times

    expect(received).toHaveLength(expected)

    Expected length: 12
    Received length: 6
    Received array:  [{"category": "Networking", "createdAt": 2026-02-10T02:36:10.225Z, "description": "Proses koneksi tiga langkah dalam 
protokol TCP", "id": "u1y17j", "title": "TCP Handshake", "updatedAt": 2026-02-10T02:36:10.225Z}, {"category": "Wawasan Kebangsaan", 
"createdAt": 2026-02-10T02:36:10.225Z, "description": "Kerakyatan yang dipimpin oleh hikmat kebijaksanaan dalam permusyawaratan/perwakilan", 
"id": "95kl2n", "title": "Pancasila Sila 4", "updatedAt": 2026-02-10T02:36:10.225Z}, {"category": "Security", "createdAt": 
2026-02-10T02:36:10.226Z, "description": "Distributed Denial of Service - serangan dari banyak sumber", "id": "bzhqx", "title": "DDoS 
Attack", "updatedAt": 2026-02-10T02:36:10.226Z}, {"category": "Networking", "createdAt": 2026-02-10T02:36:10.226Z, "description": "Proses 
koneksi tiga langkah dalam protokol TCP", "id": "bz6o8p", "title": "TCP Handshake", "updatedAt": 2026-02-10T02:36:10.226Z}, {"category": 
"Wawasan Kebangsaan", "createdAt": 2026-02-10T02:36:10.226Z, "description": "Kerakyatan yang dipimpin oleh hikmat kebijaksanaan dalam 
permusyawaratan/perwakilan", "id": "a3yzxq", "title": "Pancasila Sila 4", "updatedAt": 2026-02-10T02:36:10.226Z}, {"category": "Security", 
"createdAt": 2026-02-10T02:36:10.226Z, "description": "Distributed Denial of Service - serangan dari banyak sumber", "id": "f5k38", "title": 
"DDoS Attack", "updatedAt": 2026-02-10T02:36:10.226Z}]

    [0m [90m 205 |[39m
     [90m 206 |[39m     [90m// Should have double the data (since we're using in-memory store)[39m
    [31m[1m>[22m[39m[90m 207 |[39m     expect(secondConcepts)[33m.[39mtoHaveLength(firstConcepts[33m.[39mlength [33m*[39m 
[35m2[39m)
     [90m     |[39m                            [31m[1m^[22m[39m
     [90m 208 |[39m     expect(secondQuestions)[33m.[39mtoHaveLength(firstQuestions[33m.[39mlength [33m*[39m [35m2[39m)
     [90m 209 |[39m     expect(secondProgress)[33m.[39mtoHaveLength(firstProgress[33m.[39mlength [33m*[39m [35m2[39m)
     [90m 210 |[39m   })[0m

      at Object.toHaveLength (src/infrastructure/repositories/seed.test.ts:207:28)

FAIL src/infrastructure/repositories/in-memory-progress.repository.test.ts
  InMemoryProgressRepository
    findByUserAndConcept
      ΓêÜ should return null when progress not found (1 ms)
      ├ù should return progress when found (1 ms)
      ΓêÜ should return null when user does not match (1 ms)
      ΓêÜ should return null when concept does not match (1 ms)
    findByUserId
      ΓêÜ should return empty array for non-existent user
      ΓêÜ should return all progress for specific user (1 ms)
    create
      ΓêÜ should create progress with generated timestamps (1 ms)
      ΓêÜ should create progress with empty history (1 ms)
    update
      ΓêÜ should throw error when progress not found (3 ms)
      ├ù should update progress and set new updatedAt timestamp (1 ms)
      ΓêÜ should update progress history (1 ms)
    delete
      ΓêÜ should not throw error when deleting non-existent progress
      ΓêÜ should delete existing progress (1 ms)
    Integration with other user progress
      ΓêÜ should not affect other users progress
      ├ù should not affect other concepts progress for same user (1 ms)

  ΓùÅ InMemoryProgressRepository ΓÇ║ findByUserAndConcept ΓÇ║ should return progress when found

    ReferenceError: progress is not defined

    [0m [90m 42 |[39m         [32m'concept-1'[39m[33m,[39m
     [90m 43 |[39m       )
    [31m[1m>[22m[39m[90m 44 |[39m       expect(result)[33m.[39mtoEqual(progress)
     [90m    |[39m                              [31m[1m^[22m[39m
     [90m 45 |[39m     })
     [90m 46 |[39m
     [90m 47 |[39m     it([32m'should return null when user does not match'[39m[33m,[39m [36masync[39m () [33m=>[39m {[0m

      at Object.progress (src/infrastructure/repositories/in-memory-progress.repository.test.ts:44:30)

  ΓùÅ InMemoryProgressRepository ΓÇ║ update ΓÇ║ should update progress and set new updatedAt timestamp

    ReferenceError: progress is not defined

    [0m [90m 199 |[39m       })
     [90m 200 |[39m
    [31m[1m>[22m[39m[90m 201 |[39m       [36mconst[39m originalUpdatedAt [33m=[39m progress[33m.[39mupdatedAt
     [90m     |[39m                                 [31m[1m^[22m[39m
     [90m 202 |[39m       [36mawait[39m [36mnew[39m [33mPromise[39m((resolve) [33m=>[39m setTimeout(resolve[33m,[39m 
[35m10[39m)) [90m// Small delay[39m
     [90m 203 |[39m
     [90m 204 |[39m       [36mconst[39m updateData [33m=[39m {[0m

      at Object.progress (src/infrastructure/repositories/in-memory-progress.repository.test.ts:201:33)

  ΓùÅ InMemoryProgressRepository ΓÇ║ Integration with other user progress ΓÇ║ should not affect other concepts progress for same user

    ReferenceError: concept2Progress is not defined

    [0m [90m 359 |[39m         [32m'concept-2'[39m[33m,[39m
     [90m 360 |[39m       )
    [31m[1m>[22m[39m[90m 361 |[39m       expect(unchangedProgress)[33m.[39mtoEqual(concept2Progress)
     [90m     |[39m                                         [31m[1m^[22m[39m
     [90m 362 |[39m
     [90m 363 |[39m       [90m// Check that concept 1 progress is updated[39m
     [90m 364 |[39m       [36mconst[39m updatedProgress [33m=[39m [36mawait[39m repository[33m.[39mfindByUserAndConcept([0m

      at Object.concept2Progress (src/infrastructure/repositories/in-memory-progress.repository.test.ts:361:41)

FAIL src/infrastructure/repositories/in-memory-question.repository.test.ts
  InMemoryQuestionRepository
    findById
      ΓêÜ should return null when question is not found
      ΓêÜ should return question when found
    findByConceptId
      ΓêÜ should return empty array for non-existent concept (1 ms)
      ΓêÜ should return questions for specific concept (1 ms)
    findDueQuestions
      ΓêÜ should return empty array when no due questions
      ├ù should return questions that are due for review (1 ms)
      ΓêÜ should return empty array for user with no progress (1 ms)
    create
      ├ù should create question with generated id and timestamps (1 ms)
      ΓêÜ should create different question types (1 ms)
    update
      ΓêÜ should throw error when question not found (3 ms)
      ├ù should update question and set new updatedAt timestamp (12 ms)
    delete
      ΓêÜ should not throw error when deleting non-existent question
      ΓêÜ should delete existing question (1 ms)

  ΓùÅ InMemoryQuestionRepository ΓÇ║ findDueQuestions ΓÇ║ should return questions that are due for review

    expect(received).toHaveLength(expected)

    Expected length: 1
    Received length: 0
    Received array:  []

    [0m [90m 147 |[39m         [36mconst[39m result [33m=[39m [36mawait[39m repository[33m.[39mfindDueQuestions([32m'user-1'[39m)
     [90m 148 |[39m
    [31m[1m>[22m[39m[90m 149 |[39m         expect(result)[33m.[39mtoHaveLength([35m1[39m)
     [90m     |[39m                        [31m[1m^[22m[39m
     [90m 150 |[39m         expect(result[[35m0[39m][33m.[39mconceptId)[33m.[39mtoBe([32m'concept-due'[39m)
     [90m 151 |[39m
     [90m 152 |[39m         global[33m.[39m[33mDate[39m [33m=[39m originalDate[0m

      at Object.toHaveLength (src/infrastructure/repositories/in-memory-question.repository.test.ts:149:24)

  ΓùÅ InMemoryQuestionRepository ΓÇ║ create ΓÇ║ should create question with generated id and timestamps

    expect(received).toBeInstanceOf(expected)

    Expected constructor: mockConstructor
    Received constructor: Date

    [0m [90m 194 |[39m       expect(result[33m.[39manswerCriteria)[33m.[39mtoBe(data[33m.[39manswerCriteria)
     [90m 195 |[39m       expect(result[33m.[39mtype)[33m.[39mtoBe(data[33m.[39mtype)
    [31m[1m>[22m[39m[90m 196 |[39m       expect(result[33m.[39mcreatedAt)[33m.[39mtoBeInstanceOf([33mDate[39m)
     [90m     |[39m                                [31m[1m^[22m[39m
     [90m 197 |[39m       expect(result[33m.[39mupdatedAt)[33m.[39mtoBeInstanceOf([33mDate[39m)
     [90m 198 |[39m       expect(result[33m.[39mcreatedAt)[33m.[39mtoEqual(result[33m.[39mupdatedAt)
     [90m 199 |[39m     })[0m

      at Object.toBeInstanceOf (src/infrastructure/repositories/in-memory-question.repository.test.ts:196:32)

  ΓùÅ InMemoryQuestionRepository ΓÇ║ update ΓÇ║ should update question and set new updatedAt timestamp

    expect(received).not.toEqual(expected) // deep equality

    Expected: not 2024-01-05T00:00:00.000Z

    [0m [90m 258 |[39m       expect(result[33m.[39mtype)[33m.[39mtoBe(question[33m.[39mtype) [90m// unchanged[39m
     [90m 259 |[39m       expect(result[33m.[39mcreatedAt)[33m.[39mtoEqual(question[33m.[39mcreatedAt) [90m// unchanged[39m
    [31m[1m>[22m[39m[90m 260 |[39m       expect(result[33m.[39mupdatedAt)[33m.[39mnot[33m.[39mtoEqual(originalUpdatedAt)
     [90m     |[39m                                    [31m[1m^[22m[39m
     [90m 261 |[39m       expect(result[33m.[39mupdatedAt)[33m.[39mtoBeInstanceOf([33mDate[39m)
     [90m 262 |[39m     })
     [90m 263 |[39m   })[0m

      at Object.toEqual (src/infrastructure/repositories/in-memory-question.repository.test.ts:260:36)

PASS src/infrastructure/repositories/in-memory.repository.test.ts
  InMemoryConceptRepository
    findById
      ΓêÜ should return null when concept is not found (1 ms)
      ΓêÜ should return concept when found
    findAll
      ΓêÜ should return empty array when no concepts exist (1 ms)
      ΓêÜ should return all concepts
    findByCategory
      ΓêÜ should return empty array for non-existent category (1 ms)
      ΓêÜ should return concepts in specified category
    create
      ΓêÜ should create concept with generated id and timestamps (2 ms)
    update
      ΓêÜ should throw error when concept not found (6 ms)
      ΓêÜ should update concept and set new updatedAt timestamp (15 ms)
    delete
      ΓêÜ should not throw error when deleting non-existent concept (1 ms)
      ΓêÜ should delete existing concept

Test Suites: 3 failed, 1 passed, 4 total
Tests:       7 failed, 43 passed, 50 total
Snapshots:   0 total
Time:        0.988 s, estimated 1 s
Ran all test suites matching src/infrastructure.
